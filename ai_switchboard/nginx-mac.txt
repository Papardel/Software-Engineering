user  _www;
worker_processes  auto;
pid /opt/homebrew/var/run/nginx.pid; # path to be substituted by your own

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
    worker_connections  768;
    #multi_accept on;
}

rtmp {
    server {
        listen 1935;  # RTMP port
        chunk_size 4096;
        # ensure to create the directory for the hls_path, i.e. mnt and hls as below
        # Application for Camera 1
        application cam1 { # paths to be substituted by your own
            live on;
            hls on;
            hls_path /opt/homebrew/etc/nginx/mnt/hls/cam1/;  # Ensure separate directories for each camera
            hls_fragment 6s;
            hls_playlist_length 60s;
        }

        # Application for Camera 2
        application cam2 { # paths to be substituted by your own
            live on;
            hls on;
            hls_path /opt/homebrew/etc/nginx/mnt/hls/cam2/;  # Ensure separate directories for each camera
            hls_fragment 6s;
            hls_playlist_length 60s;
        }

        # More applications can be added for additional cameras
    }
}

http {
    server {
        listen 8080;  # Port for HTTP

        location /hls {
            # Serve HLS fragments
            types {
                application/vnd.apple.mpegurl m3u8;
                video/mp2t ts;
            }
            root /opt/homebrew/etc/nginx/mnt/; # paths to be substituted by your own
            add_header Cache-Control no-cache;
            add_header 'Access-Control-Allow-Origin' '*';
        }
    }
}

#mail {
#	# See sample authentication script at:
#	# http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript
#
#	# auth_http localhost/auth.php;
#	# pop3_capabilities "TOP" "USER";
#	# imap_capabilities "IMAP4rev1" "UIDPLUS";
#
#	server {
#		listen     localhost:110;
#		protocol   pop3;
#		proxy      on;
#	}
#
#	server {
#		listen     localhost:143;
#		protocol   imap;
#		proxy      on;
#	}
#}